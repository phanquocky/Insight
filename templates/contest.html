{% extends 'base.html' %}
{% block content %}
  
<script>
  function confirmChallenge(user) {
      const userName = user.name;
      const confirmation = window.confirm(`Do you want to challenge with ${userName}?`);
      if (confirmation) {
          sendChallenge(user);

          window.location.href = '/challenge';
      }
  }

  function sendChallenge(user) {
      fetch('/challenge', {
          method: 'POST',
          body: JSON.stringify(user),
          headers: {
            "Content-Type": "application/json",
          },
      })
      .then(response => response.text())
      .then(result => alert(result))
      .catch(error => console.log('API NOT FOUND'));
  }
</script>

  <h1 class="text-center mt-3">Contest</h1>



  {% if users %}
    <table class="table table-striped mt-3 text-center">
      <thead>
        <tr>
          <th scope="col">#ID</th>
          <th scope="col">Name</th>
          <th scope="col">Score</th>
          <!-- <th scope="col">Public Key</th> -->
          <th scope="col">Action</th>
        </tr>
      </thead>

      <tbody class="overflow-auto">
        {% for user in users %}
        <tr>
            <th scope="row" class="col-1">{{ loop.index }}</th>
            <td class="col-4">{{ user.name }}</td>
            <td class="col-1">{{ user.score }}</td>
            <!-- <td class="5 overflow-auto">{{ user.public_key }}</td> -->
            <td class="col-2">
              <div class="btn-group" role="group" aria-label="inline-btn">
                <button style="min-width: 5rem;" type="button" class="btn btn-outline-success"
                  onclick="confirmChallenge({{user}})">
                  <!-- onclick="confirmChallenge({{user|tojson|safe}})"> -->
                  Challenge
                </button>
              </div>
            </td>  
          </tr>
          {% endfor %}
      </tbody>
    </table>

  {% else %}
    <h2 class="text-center mt-3">No user found</h2>
  {% endif %}

{% endblock %}